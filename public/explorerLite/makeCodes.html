<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script>
  const i18n = {
    SIGN_AIR: 'Повітряні об’єкти',
    SIGN_AIR_MISSILE: 'Ракети',
    SIGN_SPACE: 'Космічний простір',
    SIGN_LAND_UNIT: 'Сухопутний об’єкт',
    SIGN_LAND_CIVILIAN_UNIT_ORGANIZATION: 'Цивільні об’єкти/Організації',
    SIGN_LAND_EQUIPMENT: 'Озброєння та техніка',
    SIGN_LAND_INSTALLATIONS: 'Інфраструктура',
    SIGN_CONTROL_MEASURE: 'Управлінням військами та зброєю',
    SIGN_DISMOUNTED_INDIVIDUAL: 'Піша особа',
    SIGN_SEA_SURFACE: 'Надводний простір',
    SIGN_SEA_SUBSURFACE: 'Підводний об’єкт',
    SIGN_MINE_WARFARE: 'Мінна боротьба',
    SIGN_ACTIVITY_EVENT: 'Стабільність та громадянська підтримка',
  }

  const SYMBOLS = [
    { codePart: '01', title: i18n.SIGN_AIR },
    { codePart: '02', title: i18n.SIGN_AIR_MISSILE },
    { codePart: '05', title: i18n.SIGN_SPACE },
    { codePart: '10', title: i18n.SIGN_LAND_UNIT },
    { codePart: '11', title: i18n.SIGN_LAND_CIVILIAN_UNIT_ORGANIZATION },
    { codePart: '15', title: i18n.SIGN_LAND_EQUIPMENT },
    { codePart: '20', title: i18n.SIGN_LAND_INSTALLATIONS },
    { codePart: '25', title: i18n.SIGN_CONTROL_MEASURE },
    { codePart: '27', title: i18n.SIGN_DISMOUNTED_INDIVIDUAL },
    { codePart: '30', title: i18n.SIGN_SEA_SURFACE },
    { codePart: '35', title: i18n.SIGN_SEA_SUBSURFACE },
    { codePart: '36', title: i18n.SIGN_MINE_WARFARE },
    { codePart: '40', title: i18n.SIGN_ACTIVITY_EVENT },
  ]


    async function load() {
        let z = await fetch("app6d_source.json")
        let text = await z.text()
        const inputEl = document.getElementById('input')
        inputEl.value = text
        onchange()
    }
    function onchange(){
      const inputEl = document.getElementById('input')
      const outputEl = document.getElementById('output')
      let source = inputEl.value
      const rows = JSON.parse(source)
      let i = 0;
      const titleToCode = new Map(SYMBOLS.map(({title, codePart}) => [title, codePart]))
      const icons = {}
      const modifiers1 = {}
      const modifiers2 = {}
      SYMBOLS.forEach(({codePart, title}) => {
        icons[codePart]=[]
        modifiers1[codePart]=[]
        modifiers2[codePart]=[]
      })
      for(let row; (row = rows[i]) && row[0].length; i++) {
        let [title, code, level1, level2, level3] = row
        code = code.padStart(6, '0')
        signCode = titleToCode.get(title)
        if(signCode === undefined || signCode === null) {
          console.error(row)
        }
        icons[signCode].push({id: code, title: level1 || level2 || level3})
      }
      i+=3
      for(let row; (row = rows[i]) && row[0].length; i++) {
        let [title, code, level1, level2, level3] = row
        code = code.padStart(2, '0')
        signCode = titleToCode.get(title)
        if(signCode === undefined || signCode === null) {
          console.error(row)
        }
        modifiers1[signCode].push({id: code, title: level1 || level2 || level3})
      }
      i+=3
      for(let row; (row = rows[i]) && row[0].length; i++) {
        let [title, code, level1, level2, level3] = row
        code = code.padStart(2, '0')
        signCode = titleToCode.get(title)
        if(signCode === undefined || signCode === null) {
          console.error(row)
        }
        modifiers2[signCode].push({id: code, title: level1 || level2 || level3})
      }
      outputEl.value = JSON.stringify({
        icons,
        modifiers1,
        modifiers2,
      }, null, 4)
    }
</script>
<style>
    html, body{
        width:100%;
        height: 100%;
        padding: 0;
        margin: 0;

    }
    body{
        display: flex;
    }
    #input, #output{
        width: 50vw;
        height: 100vh;
        box-sizing: border-box;
    }
</style>
<body>
<textarea id="input"></textarea>
<textarea id="output"></textarea>
<script>

    load()
</script>
</body>
</html>
